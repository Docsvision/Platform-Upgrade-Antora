= Добавление кнопки открытия карточки Согласование КС в карточку вида Задание КС - На консолидацию

. Добавьте метод, открывающий согласование, в скрипт карточки:
. Отройте _Конструктор скриптов_.
. Выберите вид _Задание КС_.
. Добавьте метод:

`csharp
  public virtual void OpenReconciliation()
  {
      this.ApprovalTaskScript.OpenReconcileCard();
  }
`

. Скомпилируйте скрипт (для проверки) и сохраните.

. Добавьте новую операцию редактирования:
. Откройте _Конструктор состояний_.

. Выберите вид _Задание КС - На консолидацию_.
. Добавьте новую операцию редактирования “Открыть карточку согласования”.
. Включите добавленную операцию для всех состояний, кроме “Подготовка” и “Завершено”.
. Сохраните.
. Настройте ролевую модель безопасности для возможности использования добавленной операции:

. Откройте _Конструктор ролей_.
. Выберите вид _Задание КС - На консолидацию_.
. Разрешите операцию “Открыть карточку согласования” всем ролям для всех состояний, кроме “Подготовка” и “Завершено”.
. Сохраните.
. Добавьте в разметку задания кнопку, открывающую согласование:

. Откройте _Конструктор разметок_.

. Выберите вид _Задание КС - На консолидацию_.

. Выберите разметку “Исполнение”.

. Откройте настройки ленты.

. Добавьте на страницу “Общая”, в группу “Действия” кнопку OpenReconciliation (Открыть карточку согласования). В качестве иконки можно выбрать Reconcile.png (из приложенного архива).

. Привяжите к кнопке операцию “Открыть карточку согласования”. 

. Добавьте для кнопки обработчик события ItemClick, с вызовом единственного метода: `OpenReconciliation()`.

image::image-20200616113411867.png[]

. Скомпилируйте и сохраните скрипт.

. Повторите операцию добавления кнопки для разметок: “Делегирование” и “Базовая”.

. Сохраните изменения.