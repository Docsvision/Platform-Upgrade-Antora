= Исключение дублирования операций

Убедиться, что у карточек базовых объектов нет операций с одинаковыми названиями. Для этого выполните следующий скрипт в БД {dv}:

[source,mssql]
----
WITH Helper ([DefaultName], [ParentRowID], [Uses])
AS
(
	SELECT [DefaultName], [ParentRowID], COUNT(*) 
	FROM [dvtable_{a5d22d25-435d-4f08-bf02-b4e9f778709f}] WITH(NOLOCK)
	GROUP BY [DefaultName], [ParentRowID]
)
SELECT tKind.[Name] [KindName], tOper.[DefaultName] [OperationName]
FROM [dbo].[dvtable_{a5d22d25-435d-4f08-bf02-b4e9f778709f}] tOper WITH(NOLOCK)
JOIN Helper tHelp ON (tOper.[DefaultName] = tHelp.[DefaultName] AND tOper.[ParentRowID] = tHelp.[ParentRowID])
JOIN [dbo].[dvtable_{ae4c7de8-ea40-4358-b8a1-f8fa6ab654e4}] tKindState WITH(NOLOCK) ON (tOper.[ParentRowID] = tKindState.[RowID])
JOIN [dbo].[dvtable_{c7ba000c-6203-4d7f-8c6b-5cb6f1e6f851}] tkind WITH(NOLOCK) ON (tKindState.[Kind] = tKind.[RowID])
WHERE tHelp.[Uses] > 1
ORDER BY tOper.[DefaultName], tKind.[Name]
----

Будут выведены названия операций с одинаковыми названиями:

image::image-20200615144802759.png[]

Если такие операции буду найдены, их необходимо переименовать в Конструкторе состояний:

image::image-20200615144903452.png[]