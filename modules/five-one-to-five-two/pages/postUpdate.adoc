= Действия после установки обновления

. *Обновление скриптов, напрямую работающих с БД.*

В новой версии {dv} изменился способ хранения расширенных метаданных в БД: теперь данные хранятся в основных таблицах секций, а не в отдельных "extended"-таблицах. При обновлении системы стандартным образом все существующие данные из "extended"-таблиц будут перенесены в основные таблицы секций, а сами "extended"-таблицы переименованы в `dvtable_{ИД секции}_extended_old_data`.

После обновления системы необходимо изменить код скриптов, напрямую обращающихся к "extended"-таблицам в БД, если такие функции были реализованы в Решении, например, для расчёта ролевой модели безопасности. К примеру, если существующий скрипт содержал обращение к таблице `dvtable_{3997861d-4ff5-496a-b8a2-d16617de91d7}_extended`, теперь нужно обращаться к таблице `dvtable_{3997861d-4ff5-496a-b8a2-d16617de91d7}`.

*Данное изменение не затрагивает динамические метаданные*. Скрипты, работающие с таблицами динамических секций и полей, изменять *не нужно*.

. *Перенос журналов в сателлитную БД.*

В версии модуля "Платформа" 5.5.2 была упразднена функция архивирования журналов работы, с помощью которой журналы можно было архивировать во внешнюю БД. Теперь журналы могут храниться в основной или сателлитной БД.

&gt; Функциональность очистки журналов с возможность сохранения резервных копий не затронута.

Если функция архивирования применялась с целью снятия нагрузки с основной БД {dv}, воспользуйтесь альтернативным решением: используйте для хранения журналов сателлитную БД. Инструкция по переносу журналов из основной БД в сателлитную приведена в руководстве администратора модуля "Платформа", пункт "Изменение места хранения журналов с основной БД на сателлитную". При этом можно отключить периодическую отчистку журналов (настройка `Журнал → Настройка бэкапа логов`).

image::image-20201012171125796.png[]

. *Обновление компонентов собственных библиотек карточек.*

В новой версии Платформы изменился механизм проверки соответствия клиентских компонентов библиотек карточек (см. список изменений модуля "Платформа" версии 5.5.2). Если в Решении на базе {dv} реализованы собственные библиотеки карточек, необходимо:

. Подключить новые сборки {dv} к проекту компонента.

. Добавить в ресурсы XML-файл с описанием библиотеки карточек.

. В реализацию класса `CardLibrary` – если .NET-сборка – добавить переопределение метода `GetLibraryDefinition`. Метод должен возвращать описание библиотеки карточек.

`csharp
  protected override string GetLibraryDefinition()
  {
    return Resources.CardLibDefinition;
  }
`

. Пересобрать, протестировать работоспособность и распространить клиентский компонент библиотеки карточек.

Для С++-реализации клиентского компонента библиотеки карточек нужно:

* поддержать интерфейс `ICardLibraryInfo2`;
* изменить поведение свойства `ICardLibraryInfo.Version`.

См. реализацию в Руководстве программиста, пример "netstatSolution".